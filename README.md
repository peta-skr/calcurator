## 📝 課題概要（Calculator – 初級）

電卓は非常に便利なツールであるだけでなく、**UI** と **イベント処理** を理解するのに最適な題材です。
この課題では、整数に対する基本的な四則演算（+ - × ÷）をサポートする電卓を作ります。

スタイル（見た目）は自由なので、自分のアイデアで作って OK です。
スマホの電卓アプリを触ってみると、機能や操作感、細かい仕様（エッジケース）を理解する助けになります。

---

## 📌 制約条件

- `eval()` 関数を使って計算してはいけない（自前の計算処理を実装する）。
- 整数（およびボーナス機能での小数）を扱う。

---

## ✅ ユーザーストーリー（満たすべき仕様）

1. **表示**

   - 現在入力中の数字、または直前の計算結果を表示する領域がある。

2. **入力ボタン**

   - 0〜9 の数字ボタン
   - 演算ボタン（`+`、`-`、`/`、`=`）
   - `C` ボタン（クリア、直前の数値または演算を取り消す）
   - `AC` ボタン（全消去、内部状態と表示を 0 に戻す）

3. **入力制限**

   - 数字は最大 8 桁まで入力できる（それ以上は無視される）。

4. **演算の動作**

   - 演算ボタンを押したら、次のどれかに対して計算を実行し、結果を表示する：

     - 直前の計算結果 と 最後に入力した数
     - 最後に入力した 2 つの数
     - 最後に入力した 1 つの数（連続演算の場合）

5. **C ボタン**

   - 最後に入力した数字 または 演算 を消す。
   - 最後に押したのが演算ボタンの場合、表示はその直前の値に戻る。

6. **AC ボタン**

   - すべての内部状態をリセットし、表示を 0 にする。

7. **エラー表示**

   - 8 桁を超える結果が出る計算は、表示に `ERR` と出す。

---

## 🎁 ボーナス機能

- `+/-` ボタンで、現在表示されている数値の符号（正 ⇔ 負）を切り替えられる。
- 小数点ボタン（`.`）を使って、小数点以下最大 3 桁までの浮動小数を入力できる。
  演算は、入力された中で最大の小数点桁数まで計算精度を保つ。

---

もしこの仕様で作る場合、次のように進めると実装しやすいです：

1. UI（数字ボタン・演算ボタン・表示部分）だけ作る
2. ボタン押下イベントで状態管理（入力中の数、直前の数、直前の演算子など）
3. 計算処理（`eval`なし）を実装
4. 桁数制限やエラー判定を追加
5. 最後にボーナス機能を追加

## テスト

いいリスト！そこに足すと良い観点を洗い出してみました。実装方針（整数のみ／小数あり、ボーナス採用可否）で要否は取捨選択してください。

# UI／入力系

- 先頭の 0 制御

  - 何も入力していないときに`0`→ 表示は`0`のまま（あなたの項目と同義）
  - `0`の後に数字 →`01`にならず`1`になる

- 桁数制限（8 桁）

  - ちょうど 8 桁は許可、9 桁目は無視
  - 桁数制限中でも演算子・`=`・`C`・`AC`は反応する

- オペレーター連打

  - 数値未入力で`+`や`-`を押したら無視 or 直前オペレーターを置換（仕様決め＆テスト）
  - `1 +`の直後に`*`→ 直前演算子が`*`に置き換わる

- 不完全式で`=`

  - `12 +`の状態で`=`→`12`をそのまま表示 or 直前数で自己演算（仕様決め）

- 表示の標準化

  - 先頭に`+`は出さない、`-0`は`0`に正規化 など

# 状態遷移（C／AC／= の挙動）

- `AC`

  - どの状態からでも内部状態リセット＆表示`0`

- `C`

  - 入力中の数がある →1 ステップでその数だけクリア（表示は直前結果または 0）
  - 直前がオペレーター → 演算子を取り消して直前の表示に戻る

- `=` 直後の操作

  - `=`の後に数字を押す → 新規入力開始（結果を上書き）
  - `=`の後にオペレーター → 結果を左オペランドとして継続計算

- `=`の連打（多くの電卓の仕様）※任意

  - `2 + 3 =`で`5`表示、さらに`=`→`8`、もう一度`=`→`11`（最後の演算を反復）

# 計算ロジック（整数／基本）

- 優先順位

  - `1 + 2 * 3 = 7`、`(1 + 2) * 3 = 9`（括弧を実装しないなら前者のみ）

- 足し算

  - 正常系、最大値境界、最小値境界、結果 8 桁超で`ERR`

- 引き算

  - 正常系、正の結果／負の結果、0 との演算（`X-0`/`0-X`）

- 掛け算

  - 正常系、×0、桁あふれ`ERR`

- 割り算

  - 正常系、0 割り →`ERR`（または特定メッセージ）、端数処理（整数電卓なら切り捨て/四捨五入の仕様決め）

- 複数演算のチェーン

  - `10 - 2 * 3 = 4`（乗除優先）
  - `8 / 2 / 2 = 2`（左結合の確認）

# エラー状態

- `ERR`の表示条件

  - 入力・計算結果が 8 桁を超える／0 割り／内部オーバーフローなど

- `ERR`からの復帰

  - `AC`で復帰、`C`や数字押下でどう振る舞うか（仕様決め）

- `ERR`中の追加操作は無視 or ビープ（表示固定）

# 符号反転（ボーナス）

- `+/-`

  - 入力中の数に対して符号反転
  - `=`直後の結果に対して反転 → そのまま次の計算の左オペランドになる
  - `0`に対して反転 →`0`のまま
  - 桁数上限に符号は含めない扱いかどうか（仕様化＆テスト）

# 小数（ボーナス：最大 3 桁）

- 入力

  - 一つの数に`.`は 1 回まで、先頭`.`は`0.`へ正規化
  - 小数部は最大 3 桁、4 桁目は無視

- 演算精度

  - 参加した数の**最大**小数桁数までで丸める（例：`1.23 + 4.5 = 5.73`、`2 / 3 = 0.667`など）

- 表示

  - 末尾の無意味な 0 は表示しない／する（仕様決め）
  - 文字数上限のカウントに`.`や符号を含めるかどうか（表示 8 桁ルールとの整合性）

- エラー

  - 小数演算でも 8 桁超で`ERR`、`ERR`復帰動作

# その他の操作系（任意）

- キーボード入力対応（`0-9`, `+ - * / = Enter Backspace`）

  - フォーカス時のみ受け付ける、未フォーカスは無視

- アクセシビリティ

  - ボタンがフォーカス可能、`Enter/Space`で押下、適切な`aria-label`

- クリップボード（任意）

  - 表示値のコピーが正しく行える

---

## サンプル境界値（整数想定）

- 最大 8 桁：`99,999,999`（負数は`-9,999,999`をどう扱うかは仕様化）
- `99,999,999 + 1 = ERR`
- `12345678 * 8 = ERR`
- `0 - 99999999 = -99999999`（表示許容？→ 負号込みで 8 桁超なら`ERR`にするか要決定）
- `1 / 3`（整数電卓なら`0`。小数対応なら`0.333`）

---

必要なら、Jest + React Testing Library での**ユニット／結合／E2E のテスト雛形**も作れます。
（例：**コア計算ロジック**は純関数でユニットテスト、**ボタン → 表示**は RTL、**シナリオ**は Playwright で E2E など）用意します？
